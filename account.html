<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>Account — Auto Hide Popup</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
<style>
:root{--green:#32cd32;--muted:#777;}
body{font-family:'Poppins',sans-serif;background:#f5f7fa;margin:0;padding:15px;padding-top:70px;padding-bottom:90px;color:#222}
.container{max-width:480px;margin:0 auto}
.header{position:fixed;top:0;left:0;width:100%;background:var(--green);color:#fff;text-align:center;padding:14px;font-size:18px;font-weight:700;box-shadow:0 2px 6px rgba(0,0,0,.15);z-index:1000}
.profile-card{background:#fff;border-radius:16px;padding:18px;text-align:center;box-shadow:0 6px 18px rgba(0,0,0,.08);margin-bottom:18px}
.profile-pic{width:100px;height:100px;margin:0 auto}
.profile-pic img{width:100px;height:100px;border-radius:18px;object-fit:cover;display:block;background:#fff}
.profile-name{font-size:18px;font-weight:600;color:#1e293b;margin-top:10px}
.profile-email{color:var(--muted);font-size:14px;margin-top:4px}
.button-box{background:#fff;border-radius:16px;box-shadow:0 6px 18px rgba(0,0,0,.08);padding:16px;margin-top:10px}
.button-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:14px}
.action-btn{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:16px;border-radius:12px;background:#fff;border:1px solid #eee;cursor:pointer;transition:all .2s;text-align:center}
.action-btn:hover{background:#f6fff6;border-color:var(--green);transform:translateY(-3px)}
.action-btn i{font-size:26px;color:var(--green);margin-bottom:8px}
.action-btn span{font-size:14px;font-weight:500;color:#222}
.btn-logout{background:#ef4444;color:#fff;width:100%;border:none;border-radius:12px;padding:12px;font-size:16px;font-weight:600;margin-top:20px;cursor:pointer}

 /* ✅ Ultra Clear Bottom Nav (No Blur, High Contrast) */
.bottom-nav {
  position: fixed;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 94%;
  max-width: 480px;
  background: #ffffff; /* solid white */
  border: 1px solid #e0e0e0;
  border-radius: 18px;
  box-shadow: 0 -6px 20px rgba(0, 0, 0, 0.08);
  display: flex;
  justify-content: space-around;
  align-items: center;
  padding: 10px 0;
  z-index: 1000;
  animation: slideUp 0.6s ease;
}

/* Slide animation */
@keyframes slideUp {
  from { transform: translate(-50%, 60px); opacity: 0; }
  to { transform: translate(-50%, 0); opacity: 1; }
}

/* Nav Items */
.nav-item {
  flex: 1;
  text-align: center;
  color: #888;
  font-size: 12px;
  text-decoration: none;
  transition: all 0.25s ease;
  position: relative;
  padding: 4px 0;
}

/* Icons */
.nav-item i {
  font-size: 22px;
  display: block;
  margin-bottom: 3px;
  color: #666;
  transition: all 0.25s ease;
  filter: none; /* remove soft edges */
}

/* Hover & Active */
.nav-item:hover i,
.nav-item.active i {
  color: #00c853;
  transform: translateY(-3px) scale(1.15);
  text-shadow: 0 0 8px rgba(0, 200, 83, 0.4);
}

.nav-item:hover span,
.nav-item.active span {
  color: #00c853;
  font-weight: 600;
}

/* Glow dot under active item */
.nav-item.active::after {
  content: "";
  position: absolute;
  bottom: -3px;
  left: 50%;
  transform: translateX(-50%);
  width: 6px;
  height: 6px;
  background: #00c853;
  border-radius: 50%;
  box-shadow: 0 0 8px rgba(0, 200, 83, 0.4);
}

/* Responsive fix */
@media(max-width:600px){
  .bottom-nav {
    border-radius: 10px;
    padding: 8px 0;
  }
  .nav-item i {
    font-size: 20px;
  }
}

/* Main Modal (Center Edit Box) */
.modal {
  display: flex;
  justify-content: center;
  align-items: center;
  position: fixed;
  top: 0; left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.45);
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease;
  z-index: 1000;
  padding: 15px; /* small padding for mobile edges */
  box-sizing: border-box;
}

.modal.show {
  opacity: 1;
  pointer-events: auto;
}

/* ✅ Responsive modal box */
.modal-content {
  background: #fff;
  border-radius: 16px;
  padding: 25px 20px;
  width: 100%;
  max-width: 420px;
  max-height: 90vh; /* prevents overflow */
  text-align: center;
  transform: scale(0.9);
  transition: transform 0.3s ease;
  box-sizing: border-box;
  overflow-y: auto; /* scroll if content bigger */
  -webkit-overflow-scrolling: touch;
}

.modal.show .modal-content {
  transform: scale(1);
}

/* Titles */
.modal-content h3 {
  margin-top: 0;
  color: #222;
}
.modal-content h4 {
  color: #555;
  margin-bottom: 10px;
  font-weight: 500;
}

/* Inputs and textarea */
.modal-content input,
.modal-content textarea {
  width: 100%;
  padding: 10px 12px;
  border: 1px solid #ccc;
  border-radius: 8px;
  font-size: 14px;
  margin-top: 10px;
  box-sizing: border-box;
}
.modal-content textarea {
  min-height: 100px;
  resize: vertical;
}

/* Action buttons */
.modal-actions {
  margin-top: 14px;
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 10px;
}
.modal-actions button {
  padding: 10px 18px;
  border-radius: 10px;
  border: none;
  cursor: pointer;
  font-weight: 600;
}
.save-btn {
  background: var(--green);
  color: #fff;
}
.cancel-btn {
  background: #ef4444;
  color: #fff;
}

/* 📱 Mobile specific tuning */
@media (max-width: 480px) {
  .modal-content {
    padding: 20px 15px;
    width: 100%;
    border-radius: 14px;
  }
  .modal-content input,
  .modal-content textarea {
    font-size: 15px;
  }
}

/* ✅ Notification popup (center auto-hide) */
.notify{
  position:fixed;
  top:50%; left:50%;
  transform:translate(-50%,-50%) scale(0.9);
  background:#333;color:#fff;
  padding:15px 25px;
  border-radius:10px;
  font-weight:500;
  font-size:15px;
  text-align:center;
  opacity:0;
  pointer-events:none;
  transition:all .4s ease;
  z-index:2000;
}
.notify.show{
  opacity:1;
  transform:translate(-50%,-50%) scale(1);
  pointer-events:auto;
}
.notify.success{background:#32cd32;}
.notify.error{background:#e53935;}

/* 🌟 Premium text look for Joining Date */
.join-date-text {
  margin-top: 6px;
  font-size: 13.5px;
  font-weight: 600;
  background: linear-gradient(90deg, #16a34a, #4ade80);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  letter-spacing: 0.3px;
  transition: all 0.3s ease;
}



.join-date-text:hover {
  filter: brightness(1.1);
  transform: scale(1.02);
}

</style>
</head>
<body>
<div class="header">My Account</div>

<div class="container">
  <div class="profile-card">
    <div class="profile-pic"><img id="profileImage" alt=""></div>
  <div id="userJoinDate" class="join-date-text">Joining Date: Loading...</div>


<div id="userName" class="profile-name">Loading...</div>
<div id="userEmail" class="profile-email">Loading...</div>

  </div>

  <div class="button-box">
    <div class="button-grid">
      <div class="action-btn" onclick="openModal('Edit Email')"><i class='bx bx-envelope'></i><span> Email</span></div>
      <div class="action-btn" onclick="openModal('Edit Password')"><i class='bx bx-lock'></i><span> Password</span></div>
      <div class="action-btn" onclick="openModal('Edit Mobile')"><i class='bx bx-mobile'></i><span> Mobile</span></div>
      <div class="action-btn" onclick="window.location.href='withdrawal.html'"><i class='bx bx-wallet'></i><span> Wallet</span></div>
      <div class="action-btn" onclick="openModal('Revenue Details')"><i class='bx bx-line-chart'></i><span>Revenue</span></div>
      <div class="action-btn" onclick="openModal('Withdrawal Report')"><i class='bx bx-file'></i><span>Withdrawal Report</span></div>
    </div>
  </div>

  <button class="btn-logout" onclick="logout()"> Log out</button>
</div>

<!-- Bottom Navigation -->
<div class="bottom-nav">
  <a href="Dashboard.html" class="nav-item active"><i class='bx bxs-dashboard'></i><span>Home</span></a>
  <a href="mining.html" class="nav-item"><i class='bx bxs-coin-stack'></i><span>Invest</span></a>
  <a href="promotion.html" class="nav-item"><i class='bx bxs-user-plus'></i><span>Refer</span></a>
  <a href="account.html" class="nav-item"><i class='bx bxs-user-circle'></i><span>Account</span></a>
</div>

<script>
  // 🔥 Bottom nav auto-active highlight logic
  const navLinks = document.querySelectorAll(".bottom-nav a");

  // current page ka URL filename nikalta hai (e.g., mining.html)
  const currentPage = window.location.pathname.split("/").pop();

  navLinks.forEach(link => {
    const linkPage = link.getAttribute("href");

    if (linkPage === currentPage) {
      link.classList.add("active"); // ✅ Active highlight add karega
    } else {
      link.classList.remove("active");
    }

    // Optional: click par bhi active ho turant
    link.addEventListener("click", () => {
      navLinks.forEach(nav => nav.classList.remove("active"));
      link.classList.add("active");
    });
  });
</script>
<!-- Modal -->
<div class="modal" id="popupModal">
  <div class="modal-content">
    <h4 id="modalUser">Hey User 👋</h4>
    <h3 id="modalTitle"></h3>
    <input id="modalInput" type="text" placeholder="Enter value" style="display:none">
    <textarea id="modalTextarea" placeholder="Enter details..." style="display:none"></textarea>
    <div class="modal-actions">
      <button class="save-btn" onclick="saveModal()">Save</button>
      <button class="cancel-btn" onclick="closeModal()">Close</button>
    </div>
  </div>
</div>

<!-- Notification -->
<div id="notify" class="notify"></div>

<script type="module">
import {initializeApp} from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import {getFirestore,doc,getDoc,updateDoc,arrayUnion} from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
import {getAuth,onAuthStateChanged,signOut,updateEmail as fbUpdateEmail,updatePassword as fbUpdatePassword} from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

const firebaseConfig={apiKey:"AIzaSyDEQYPJFxQv8yFHptrTqoLHOn2L0PpgVhc",authDomain:"btcinvest-c0e25.firebaseapp.com",projectId:"btcinvest-c0e25",storageBucket:"btcinvest-c0e25.firebasestorage.app",messagingSenderId:"204937458487",appId:"1:204937458487:web:cc27ece1249999279f60b2"};
const app=initializeApp(firebaseConfig);
const db=getFirestore(app);
const auth=getAuth(app);

const modal=document.getElementById("popupModal");
const notify=document.getElementById("notify");
const modalTitle=document.getElementById("modalTitle");
const modalUser=document.getElementById("modalUser");
const modalInput=document.getElementById("modalInput");
const modalTextarea=document.getElementById("modalTextarea");
const userNameEl=document.getElementById("userName");
const userEmailEl=document.getElementById("userEmail");
const profileImage=document.getElementById("profileImage");

let currentUser,userDocRef,currentAction;
profileImage.src=`https://i.pravatar.cc/150?img=${Math.floor(Math.random()*70)+1}`;

function maskEmail(e){if(!e)return"";const[n,d]=e.split("@");return n.substring(0,3)+"****@"+d;}

onAuthStateChanged(auth,async user=>{
 if(!user){location.href="login.html";return;}
 currentUser=user;
 userDocRef=doc(db,"users",user.uid);
 const s=await getDoc(userDocRef);
 const data=s.exists()?s.data():{};
const uname = data.name || "User";

let joinDateText = "Not set";
let daysSince = "";

// ✅ createdAt se date aur difference nikaalna
if (data.createdAt) {
  const joinDate = new Date(data.createdAt);
  const now = new Date();

// Compare only by date (ignore timezone hours)
const joinDay = new Date(joinDate.getFullYear(), joinDate.getMonth(), joinDate.getDate());
const todayDay = new Date(now.getFullYear(), now.getMonth(), now.getDate());

const diffMs = todayDay - joinDay;
const diffDays = Math.round(diffMs / (1000 * 60 * 60 * 24));


joinDateText = joinDate.toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' });

  if (diffDays === 0) daysSince = " (Joined today)";
  else if (diffDays === 1) daysSince = " (1 day ago)";
  else if (diffDays < 30) daysSince = ` (${diffDays} days ago)`;
  else {
    const months = Math.floor(diffDays / 30);
    const days = diffDays % 30;
    daysSince = ` (${months} month${months > 1 ? "s" : ""} ${days} day${days > 1 ? "s" : ""} ago)`;
  }
}

// ✅ UI me dikhana
document.getElementById("userJoinDate").textContent = `${joinDateText}${daysSince}`;
userNameEl.textContent = uname;
userEmailEl.textContent = maskEmail(data.email || user.email);
modalUser.textContent = `Hey ${uname} 👋`;

});

window.openModal=(a)=>{
 currentAction=a;
 modal.classList.add("show");
 modalInput.style.display="none";
 modalTextarea.style.display="none";
 if(a==="Revenue Details"||a==="Withdrawal Report"){modalTextarea.style.display="block";modalTitle.textContent=a;}
 else{modalInput.style.display="block";modalTitle.textContent=a;}
};
window.closeModal=()=>{modal.classList.remove("show");setTimeout(()=>{modalInput.value="";modalTextarea.value="";},300);};

function showNotify(msg,type="success"){
 notify.textContent=msg;
 notify.className=`notify show ${type}`;
 setTimeout(()=>{notify.classList.remove("show");},2000);
}

window.saveModal=async()=>{
 if(!currentUser){showNotify("User not loaded","error");return;}
 const val=modalTextarea.style.display==="block"?modalTextarea.value.trim():modalInput.value.trim();
 if(!val){showNotify("Please enter details","error");return;}
 try{
  if(currentAction==="Edit Email"){await fbUpdateEmail(currentUser,val);await updateDoc(userDocRef,{email:val});userEmailEl.textContent=maskEmail(val);showNotify("Email updated ✅");}
  else if(currentAction==="Edit Password"){await fbUpdatePassword(currentUser,val);showNotify("Password updated ✅");}
  else if(currentAction==="Edit Mobile"){await updateDoc(userDocRef,{mobileNumber:val});showNotify("Mobile updated ✅");}
  else if(currentAction==="Revenue Details"){await updateDoc(userDocRef,{revenueInfo:val});showNotify("Revenue details sent ✅");}
  else if(currentAction==="Withdrawal Report"){
    const r={email:currentUser.email,message:val,time:new Date().toISOString()};
    await updateDoc(userDocRef,{withdrawalReports:arrayUnion(r)});
    showNotify("Withdrawal report sent ✅");
  }
 }catch(e){showNotify("Error: "+e.message,"error");}
 closeModal();
};

window.logout=async()=>{await signOut(auth);location.href="login.html";};
modal.addEventListener("click",e=>{if(e.target===modal)closeModal();});
</script>
  <script>
  // 🚫 Disable right click, select, drag
  document.addEventListener("contextmenu", e => e.preventDefault());
  document.addEventListener("selectstart", e => e.preventDefault());
  document.addEventListener("dragstart", e => e.preventDefault());

  // 🚫 Disable keyboard shortcuts (copy, paste, inspect, etc.)
  document.addEventListener("keydown", e => {
    if (
      e.key === "F12" ||
      (e.ctrlKey && e.shiftKey && (e.key === "I" || e.key === "J")) ||
      (e.ctrlKey && (e.key === "U" || e.key === "C" || e.key === "X" || e.key === "V" || e.key === "S"))
    ) {
      e.preventDefault();
      return false;
    }
  });

  // 🔒 Silent DevTools detection (no popup)
  (function() {
    const devtools = /./;
    devtools.toString = function() {
      return ""; // no alert or console log
    };
    console.log("%c", devtools);
  })();

  // 🔐 Detect DevTools using resize trick (no popup)
  setInterval(() => {
    const threshold = 160;
    const widthDiff = window.outerWidth - window.innerWidth > threshold;
    const heightDiff = window.outerHeight - window.innerHeight > threshold;
    if (widthDiff || heightDiff) {
      // Optional: silently redirect or blank the page
      document.body.innerHTML = "";
    }
  }, 1000);

  // 🧱 Disable copy/paste/cut
  ["copy", "paste", "cut"].forEach(evt =>
    document.addEventListener(evt, e => e.preventDefault())
  );

  // 🔁 Freeze console methods silently
  Object.freeze(console);
  Object.freeze(window.console);
</script>


</body>
</html>
