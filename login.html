<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>User Login</title>
  <style>
    body {
      font-family: 'Poppins', sans-serif; 
      background: linear-gradient(135deg, #e3f2fd, #f9f9f9); 
      margin:0; 
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 20px;
    }

    /* Header fixed */
    .header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;   
      width: 100%;
      text-align: center;
      padding: 14px;
      font-size: 20px;
      font-weight: bold;
      background: linear-gradient(90deg,#4CAF50,#2c7);
      color: white;
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
      z-index: 1000;
    }

    .wrapper {
      margin-top: 90px; /* Header ke neeche space */
      width: 100%;
      max-width: 400px;
    }

    /* Card style */
    .card {
      background: #fff;
      padding: 25px 30px;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.15);
      margin-bottom: 20px;
      text-align:center;
    }

    .tagline {
      font-size: 15px; 
      color: #222;
      font-weight: 600;
      margin-bottom: 10px;
    }

    h2 { margin:0 0 15px 0; font-size:22px; font-weight:bold; color:#333; }

    /* Floating input group */
    .input-group {
      position: relative;
      margin: 20px 0;
      width: 100%;
    }
    .input-group input {
      width: 100%;
      padding: 14px 12px;
      font-size: 15px;
      border: 1.5px solid #ccc;
      border-radius: 8px;
      outline: none;
      box-sizing: border-box;
      background: #fff;
      transition: 0.3s;
    }
    .input-group label {
      position: absolute;
      left: 12px;
      top: 14px;
      font-size: 15px;
      color: #888;
      pointer-events: none;
      transition: 0.3s;
      background: #fff;
      padding: 0 4px;
    }
    .input-group input:focus {
      border-color: #4CAF50;
      box-shadow: 0 0 6px rgba(76,175,80,0.3);
    }
    .input-group input:focus + label,
    .input-group input:not(:placeholder-shown) + label {
      top: -8px;
      font-size: 12px;
      color: #4CAF50;
    }

    /* Password eye icon */
    .password-container i {
      position: absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      cursor: pointer;
      font-size: 16px;
      color: #444;
    }

    /* Buttons */
    button {
      width: 100%; padding: 12px; margin-top: 10px;
      border: none; border-radius: 6px;
      background: linear-gradient(90deg,#4CAF50,#2c7);
      color: white;
      font-size: 16px; font-weight:bold;
      cursor: pointer; transition: 0.3s;
    }
    button:hover { background:#3a9440; }

    .forgot-btn {
      margin-top: 8px;
      background: none; border: none;
      color: #0066ff; font-size: 14px;
      cursor: pointer; text-decoration: underline;
    }
    .forgot-btn:hover { color: #0040aa; }

    .login-box {
      margin-top: 14px; padding: 10px;
      border: 1px solid #ddd; border-radius: 6px;
      background: #f9f9f9; font-size: 14px; color: #333;
    }
    .login-box a { color: #0066ff; font-weight: bold; text-decoration: none; }
    .login-box a:hover { text-decoration: underline; }

    .info-box {
      background: #eef5ff;
      border: 1px solid #cce0ff; border-radius: 10px;
      padding: 18px; 
      font-size: 14px; color: #222;
      text-align:left;
    }
    .info-box h3 {
      margin-top: 0; font-size: 16px; color: #0066ff;
    }
    .info-box ul { padding-left: 18px; margin:0; }
    .info-box li { margin: 6px 0; }

    /* Popup overlay */
    .popup-overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.4);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 2000;
    }
    .popup {
      background: #fff;
      padding: 20px 30px;
      border-radius: 16px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.2);
      text-align: center;
      font-size: 16px;
      font-weight: bold;
      color: #333;
      transform: scale(0.8);
      opacity: 0;
      transition: all 0.3s ease-in-out;
    }
    .popup.show { transform: scale(1); opacity: 1; }
    .popup.success { border-left: 6px solid #28a745; }
    .popup.error { border-left: 6px solid #dc3545; }

    /* Loader */
    .loader {
      border: 3px solid #f3f3f3;
      border-top: 3px solid #fff;
      border-radius: 50%;
      width: 18px; height: 18px;
      animation: spin 1s linear infinite;
      display:inline-block;
    }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    @media (max-width: 480px) {
      .wrapper { padding: 10px; }
      .card { padding: 20px; }
    }
  </style>
</head>
<body>

  <div class="header">ğ€ğœğœğğ¬ğ¬ ğ˜ğ¨ğ®ğ« ğ€ğœğœğ¨ğ®ğ§ğ­ ğ’ğšğŸğğ¥ğ²</div>

  <div id="popupOverlay" class="popup-overlay">
    <div id="popup" class="popup"></div>
  </div>

  <div class="wrapper">
    

<!-- Tagline -->
<div class="card">
  <div class="tagline" id="tagline"></div>
</div>

<style>
.tagline {
  font-size: 16px;
  font-weight: 600;
  color: #333;
  text-align: left;
  margin: 0 auto;
  max-width: 100%;
  line-height: 1.6;
  word-wrap: break-word;   /* âœ… allow wrapping */
}

.tagline span.num {
  color: #28a745;   /* âœ… Green numbers */
  font-weight: bold;
}

.line {
  border-right: 2px solid #4CAF50; /* cursor */
  display: block;                  /* âœ… full width line */
  white-space: normal;             /* âœ… allow wrapping inside box */
  word-wrap: break-word;           /* âœ… break long text */
  overflow: hidden;
  margin-bottom: 6px;
}

</style>

<script>
  const texts = [
    "<span class='num'>1</span> =  Access Your Account with Blockchain-Powered Security",
    "<span class='num'>2</span> = âš¡ Fast Â· Secure Â· Transparent â€“ Your Digital Wallet, Simplified",
    "<span class='num'>3</span> = ğŸ’ Protecting Your Wealth with Next-Gen Blockchain Security",
    "<span class='num'>4</span> =  Login Securely. Invest Smartly. Earn Confidently."
  ];

  const tagline = document.getElementById("tagline");
  let count = 0;

  function typeLine(text, callback) {
    let i = 0;
    const lineDiv = document.createElement("div");
    lineDiv.className = "line";
    tagline.appendChild(lineDiv);

    function typing() {
      if (i < text.length) {
        lineDiv.innerHTML = text.substring(0, i+1);
        i++;
        setTimeout(typing, 40); // typing speed
      } else {
        lineDiv.style.borderRight = "none"; // remove cursor after complete
        if (callback) setTimeout(callback, 500);
      }
    }
    typing();
  }

  function startTyping() {
    if (count < texts.length) {
      typeLine(texts[count], () => {
        count++;
        startTyping();
      });
    }
  }

  startTyping();
</script>

    <!-- Login Form -->
    <div class="card">
      <h2>Login</h2>

      <div class="input-group">
        <input type="text" id="login-identifier" placeholder=" " required>
        <label for="login-identifier">Email / Mobile / Username</label>
      </div>

      <div class="input-group password-container">
        <input type="password" id="login-password" placeholder=" " required>
        <label for="login-password">Password</label>
        <i id="toggle-password">ğŸ‘ï¸</i>
      </div>

      <button id="loginBtn">Login</button>
      <button type="button" id="forgot-btn" class="forgot-btn">Forgot Password?</button>
      
      <div class="login-box">
        Donâ€™t have an account? <a href="register.html">Register here</a>
      </div>
    </div>

    <!-- Blockchain Info -->
    <div class="card info-box">
      <h3>Why Choose Us?</h3>
      <ul>
        <li>âœ… Powered by Blockchain Security</li>
        <li>âœ… Earn Referral Income up to 3 Levels</li>
        <li>âœ… Wallet Balance Stored Safely in USDT</li>
        <li>âœ… Instant and Transparent Transactions</li>
      </ul>
    </div>
  </div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
  import { getAuth, signInWithEmailAndPassword, sendPasswordResetEmail } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";
  import { getFirestore, collection, getDocs, query, where } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDEQYPJFxQv8yFHptrTqoLHOn2L0PpgVhc",
    authDomain: "btcinvest-c0e25.firebaseapp.com",
    projectId: "btcinvest-c0e25",
    storageBucket: "btcinvest-c0e25.firebasestorage.app",
    messagingSenderId: "204937458487",
    appId: "1:204937458487:web:cc27ece1249999279f60b2",
    measurementId: "G-HG0Q8ZHT6G"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  const popup = document.getElementById('popup');
  const popupOverlay = document.getElementById('popupOverlay');

  function showPopup(msg, type='success'){
    popup.textContent = msg;
    popup.className = "popup";
    popup.classList.add(type, "show");
    popupOverlay.style.display = 'flex';
    setTimeout(()=>{
      popup.classList.remove("show", "success", "error");
      popupOverlay.style.display = 'none';
    }, 2000);
  }

  document.getElementById("toggle-password").addEventListener("click", ()=>{
    const pass = document.getElementById("login-password");
    pass.type = pass.type === "password" ? "text" : "password";
  });

  document.getElementById("loginBtn").addEventListener("click", async ()=>{
    const loginBtn = document.getElementById("loginBtn");
    const identifierInput = document.getElementById("login-identifier").value.trim();
    let identifier = identifierInput;
    if(identifier.includes("@")){ identifier = identifier.toLowerCase(); }
    const password = document.getElementById("login-password").value.trim();
    if(!identifier || !password){ showPopup("Please enter details.","error"); return; }

    showPopup("Checking credentials...","success");

    try {
      const usersRef = collection(db, "users");
      let q, type="";
      if(identifier.includes("@")){ q=query(usersRef, where("email", "==", identifier.toLowerCase())); type="email"; }
      else if(/^\d{10}$/.test(identifier)){ q=query(usersRef, where("mobile", "==", identifier)); type="mobile"; }
      else{ q=query(usersRef, where("username", "==", identifier)); type="username"; }

      const snap = await getDocs(q);
      if(snap.empty){ showPopup("Account not found ("+type+")","error"); return; }

      const userDoc = snap.docs[0];
      const userEmail = userDoc.data().email;
      try {
        await signInWithEmailAndPassword(auth, userEmail, password);
        loginBtn.disabled = true;
        loginBtn.innerHTML = `<span class="loader"></span> Logging in...`;
        showPopup("Welcome "+(userDoc.data().name || ""), "success");
        setTimeout(()=>{ window.location.href = "Dashboard.html"; },1500);
      } catch(e){ showPopup("Incorrect password.","error"); return; }

    } catch(err){ console.error(err); showPopup("Login error","error"); }
  });

  document.getElementById("forgot-btn").addEventListener("click", async ()=>{
    const email = document.getElementById("login-identifier").value.trim();
    if(!email.includes("@")){ showPopup("Enter valid email.","error"); return; }
    try {
      await sendPasswordResetEmail(auth, email);
      showPopup("Password reset link sent.","success");
    } catch(err){ showPopup(err.message,"error"); }
  });
</script>
</body>
</html>
