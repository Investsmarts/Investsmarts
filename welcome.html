<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Welcome | TRUSTdollar V2</title>
  <style>
    * {margin:0;padding:0;box-sizing:border-box;font-family:"Poppins",sans-serif;}
  body {
  height: 100vh;
  width: 100vw;
  background: radial-gradient(circle at center, #00ff99, #004d1a, #001a0d);
  background-size: 400% 400%;
  animation: gradient 10s ease infinite;

  /* üëá ye 3 line changes hain */
  display: flex;
  justify-content: center;
  align-items: flex-start; /* Center ke jagah upar karne ke liye */
  text-align: center;
  overflow: hidden;
  padding-top: 60px; /* Thoda upar dikhane ke liye space */
}

@media (max-height: 700px) {
  body { padding-top: 30px; }
}
@media (min-height: 900px) {
  body { padding-top: 100px; }
}

    .card {
      background:#fff;border-radius:20px;padding:30px;width:90%;max-width:380px;text-align:center;
      box-shadow:0 0 35px rgba(0,255,120,0.5);color:#111;animation:fadeIn 1s ease;
    }
    @keyframes fadeIn {from{opacity:0;transform:scale(0.9);}to{opacity:1;transform:scale(1);}}
    h1{color:#009933;font-size:1.8rem;margin-bottom:10px;font-weight:700;}
    h2{color:#004d1a;font-size:1.2rem;margin-bottom:15px;font-weight:600;}
    p{color:#444;font-size:0.9rem;margin-bottom:10px;}
    input{width:100%;padding:10px;border:2px solid #00c070;border-radius:8px;font-weight:600;text-align:center;color:#004d1a;margin-bottom:10px;}
    .qr-box{margin-top:15px;display:flex;justify-content:center;}
    canvas{border:2px solid #00ff88;border-radius:8px;padding:6px;width:180px;height:180px;}
    .btns{margin-top:20px;display:flex;justify-content:space-between;gap:10px;}
    button{flex:1;padding:10px;border:none;border-radius:8px;color:white;font-weight:600;cursor:pointer;transition:0.3s;}
    .copy-btn{background-color:#007bff;}.share-btn{background-color:#ffb300;}button:hover{transform:scale(1.05);}
    .msg{color:#008000;font-size:0.9rem;margin-top:8px;font-weight:600;}
    footer{position:fixed;bottom:10px;color:#a6ffb0;font-size:0.8rem;text-align:center;width:100%;}
    .popup-overlay {position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.65);
      display:none;justify-content:center;align-items:center;z-index:999;animation:fadeIn 0.3s ease;}
    .popup-card {background:#ffffff;border-radius:15px;padding:20px;width:90%;max-width:350px;text-align:center;
      box-shadow:0 0 25px rgba(0,255,120,0.5);color:#004d1a;animation:scaleIn 0.3s ease;}
   @keyframes scaleIn {
  from { transform: scale(0.8); opacity: 0; }
  to   { transform: scale(1); opacity: 1; }
}

    .popup-card h2{color:#00c070;font-size:1.1rem;margin-bottom:8px;font-weight:700;}
    .popup-card p{color:#333;font-size:0.88rem;margin-bottom:18px;line-height:1.4;}
    .popup-btns button{background-color:#00c070;color:white;border:none;padding:8px 16px;border-radius:8px;font-weight:600;cursor:pointer;transition:0.3s;font-size:0.9rem;}
    .popup-btns button:hover{background-color:#009c55;}
  </style>
</head>
<body>
  <div class="card">
    <h1>Welcome to TRUSTdollar V2</h1>
    <h2 id="userName">Loading user...</h2>
    <p>Your personal referral link:</p>
    <input type="text" id="refLink" readonly />
    <div class="qr-box"><canvas id="qrCode"></canvas></div>
    <div class="btns">
      <button class="copy-btn" onclick="copyLink()">Copy Link</button>
      <button class="share-btn" onclick="shareLink()">Share Link</button>
    </div>
    <div class="msg" id="msg"></div>
  </div>

  <footer>¬© 2025 TRUSTdollar V2 ‚Äî All Rights Reserved.</footer>

  <!-- English Popup -->
  <div id="popupEng" class="popup-overlay">
    <div class="popup-card">
      <h2> Important Update: Re-Registration in Progress</h2>
      <p>
        We are upgrading our system for better security and performance.<br><br>
        All existing users are being registered under our new, more secure <strong>TrustDollar V2</strong> system.<br><br>
        Please make sure to complete your registration with your team as soon as possible.<br><br>
        The sooner you register, the sooner we can take TrustDollar live with full features and benefits.<br><br>
        Thank you for your continued trust and support.<br>
        Together, we build a stronger future with <strong>TrustDollar</strong>. üíö
      </p>
      <div class="popup-btns"><button onclick="nextPopup()">Got It</button></div>
    </div>
  </div>

  <!-- Hindi Popup -->
  <div id="popupHin" class="popup-overlay">
    <div class="popup-card">
      <h2> ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§∏‡•Ç‡§ö‡§®‡§æ: ‡§™‡•Å‡§®‡§É ‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£ ‡§ú‡§æ‡§∞‡•Ä ‡§π‡•à</h2>
      <p>
        ‡§π‡§Æ ‡§Ö‡§™‡§®‡•á ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§ï‡•ã ‡§¨‡•á‡§π‡§§‡§∞ ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§î‡§∞ ‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç‡•§<br><br>
        ‡§∏‡§≠‡•Ä ‡§Æ‡•å‡§ú‡•Ç‡§¶‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§Ö‡§¨ ‡§π‡§Æ‡§æ‡§∞‡•á ‡§®‡§è ‡§î‡§∞ ‡§Ö‡§ß‡§ø‡§ï ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ <strong>TrustDollar V2 ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ</strong> ‡§Æ‡•á‡§Ç <strong>‡§™‡•Å‡§®‡§É ‡§™‡§Ç‡§ú‡•Ä‡§ï‡•É‡§§</strong> ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à‡•§<br><br>
        ‡§ï‡•É‡§™‡§Ø‡§æ ‡§Ü‡§™ ‡§î‡§∞ ‡§Ü‡§™‡§ï‡•Ä ‡§ü‡•Ä‡§Æ ‡§ú‡§ø‡§§‡§®‡•Ä ‡§ú‡§≤‡•ç‡§¶‡•Ä ‡§π‡•ã ‡§∏‡§ï‡•á ‡§®‡§Ø‡§æ ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•á‡§∂‡§® ‡§™‡•Ç‡§∞‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§<br><br>
        ‡§ú‡§ø‡§§‡§®‡•Ä ‡§ú‡§≤‡•ç‡§¶‡•Ä ‡§Ü‡§™ ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ ‡§ï‡§∞‡•á‡§Ç‡§ó‡•á, ‡§â‡§§‡§®‡•Ä ‡§ú‡§≤‡•ç‡§¶‡•Ä ‡§π‡§Æ <strong>TrustDollar</strong> ‡§ï‡•ã ‡§™‡•Ç‡§∞‡•Ä ‡§∏‡•Å‡§µ‡§ø‡§ß‡§æ‡§ì‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§≤‡§æ‡§á‡§µ ‡§ï‡§∞ ‡§™‡§æ‡§è‡§Ç‡§ó‡•á‡•§<br><br>
        ‡§Ü‡§™‡§ï‡•á ‡§®‡§ø‡§∞‡§Ç‡§§‡§∞ ‡§µ‡§ø‡§∂‡•ç‡§µ‡§æ‡§∏ ‡§î‡§∞ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ß‡§®‡•ç‡§Ø‡§µ‡§æ‡§¶‡•§<br>
        ‡§Ü‡§á‡§è ‡§Æ‡§ø‡§≤‡§ï‡§∞ <strong>TrustDollar</strong> ‡§ï‡•á ‡§∏‡§æ‡§• ‡§è‡§ï ‡§Æ‡§ú‡§¨‡•Ç‡§§ ‡§≠‡§µ‡§ø‡§∑‡•ç‡§Ø ‡§¨‡§®‡§æ‡§§‡•á ‡§π‡•à‡§Ç‡•§ üíö
      </p>
      <div class="popup-btns"><button onclick="closePopup()">‡§†‡•Ä‡§ï ‡§π‡•à</button></div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/qrious@4.0.2/dist/qrious.min.js"></script>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDEQYPJFxQv8yFHptrTqoLHOn2L0PpgVhc",
      authDomain: "btcinvest-c0e25.firebaseapp.com",
      projectId: "btcinvest-c0e25",
      storageBucket: "btcinvest-c0e25.firebasestorage.app",
      messagingSenderId: "204937458487",
      appId: "1:204937458487:web:cc27ece1249999279f60b2",
      measurementId: "G-HG0QZHT6G"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

  onAuthStateChanged(auth, async (user) => {
  if (user) {
    const uid = user.uid;
    const userRef = doc(db, "users", uid);
    const docSnap = await getDoc(userRef);

    if (docSnap.exists()) {
      const data = docSnap.data();

      // ‚úÖ Use username field from Firestore
      const name = data.username || data.name || user.displayName || "Trust User";

      // ‚úÖ Use referralCode field (not UID)
      const refLink = `https://smartfundad.com/index.html?ref=${data.referralCode}`;
      showUser(name, refLink);

    } else {
      // ‚ö° Fallback if no data found for user
      const name = user.displayName || "New User";
      const refLink = `https://smartfundad.com/index.html?ref=UNKNOWN`;
      showUser(name, refLink);
    }

  } else {
    document.getElementById("userName").innerText = "Please Login First";
  }
});


    function showUser(name, link) {
      document.getElementById("userName").innerText = `Welcome, ${name}!`;
      document.getElementById("refLink").value = link;
      new QRious({
        element: document.getElementById("qrCode"),
        value: link,
        size: 180,
        background: "white",
        foreground: "#004d1a"
      });
    }

    window.copyLink = function(){
      const input=document.getElementById("refLink");
      input.select();document.execCommand("copy");
      document.getElementById("msg").innerText="‚úÖ Link copied successfully!";
      setTimeout(()=>document.getElementById("msg").innerText="",2000);
    };

    window.shareLink = function(){
      const link=document.getElementById("refLink").value;
      if(navigator.share){
        navigator.share({title:"Join TRUSTdollar V2",text:"Use my referral link to register:",url:link});
      } else {window.open(link,"_blank");}
    };

    window.addEventListener("load",()=>{document.getElementById("popupEng").style.display="flex";});
    window.nextPopup=function(){
      document.getElementById("popupEng").style.display="none";
      setTimeout(()=>{document.getElementById("popupHin").style.display="flex";},300);
    };
    window.closePopup=function(){document.getElementById("popupHin").style.display="none";};
  </script>
</body>
</html>
