<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Add Multiple Wallets</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      background: #f5f7fa;
      color: #333;
    }

    .popup {
      background: #fff;
      border-radius: 14px;
      padding: 20px;
      max-width: 340px;
      margin: 40px auto;
      box-shadow: 0 6px 18px rgba(0,0,0,0.15);
      text-align: center;
    }

    h2 {
      margin-bottom: 15px;
      font-size: 18px;
      color: #28a745;
    }

    label {
      font-size: 13px;
      font-weight: 600;
      display: block;
      text-align: left;
      margin-top: 10px;
    }

    select, input {
      width: 100%;
      padding: 10px;
      margin-top: 6px;
      border: 1.5px solid #ccc;
      border-radius: 8px;
      font-size: 14px;
      outline: none;
    }

    .action-buttons {
      display: flex;
      gap: 10px;
      margin-top: 18px;
    }

    .action-buttons button {
      flex: 1;
      padding: 10px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      font-size: 13px;
      color: #fff;
      transition: 0.3s;
    }

    .add-btn { background: #007bff; }
    .add-btn:hover { background: #0069d9; }

    .primary-btn { background: #28a745; }
    .primary-btn:hover { background: #218838; }

    .msg {
      margin-top: 12px;
      font-size: 13px;
      color: #666;
    }
  </style>
</head>
<body>

<div class="popup">
  <h2>Add Wallet Address</h2>

  <label>Select Wallet Type</label>
  <select id="walletType">
    <option value="USDT (BEP20)">USDT (BEP20)</option>
    <option value="USDT (TRC20)">USDT (TRC20)</option>
    <option value="BTC">Bitcoin (BTC)</option>
    <option value="ETH">Ethereum (ETH)</option>
  </select>

  <label>Wallet Address</label>
  <input type="text" id="walletAddress" placeholder="Paste wallet address here">

  <div class="action-buttons">
    <button class="add-btn" onclick="addWallet()">➕ Add Address</button>
    <button class="primary-btn" onclick="setPrimary()">⭐ Set Primary</button>
  </div>

  <div id="message" class="msg"></div>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
  import { getFirestore, collection, addDoc, doc, updateDoc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDEQYPJFxQv8yFHptrTqoLHOn2L0PpgVhc",
    authDomain: "btcinvest-c0e25.firebaseapp.com",
    projectId: "btcinvest-c0e25",
    storageBucket: "btcinvest-c0e25.firebasestorage.app",
    messagingSenderId: "204937458487",
    appId: "1:204937458487:web:cc27ece1249999279f60b2",
    measurementId: "G-HG0Q8ZHT6G"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  let currentUserId = null;

  const msg = document.getElementById("message");

  function showMessage(text, color="#28a745") {
    msg.textContent = text;
    msg.style.color = color;
  }

  window.addWallet = async function() {
    const type = document.getElementById("walletType").value;
    const address = document.getElementById("walletAddress").value.trim();

    if (!address || address.length < 15) {
      showMessage("⚠️ Enter a valid wallet address", "red");
      return;
    }

    if (currentUserId) {
      await addDoc(collection(db, "users", currentUserId, "wallets"), {
        type: type,
        address: address,
        addedAt: new Date()
      });
      showMessage("✅ Wallet added successfully!");
      document.getElementById("walletAddress").value = "";
    }
  }

  window.setPrimary = async function() {
    const address = document.getElementById("walletAddress").value.trim();

    if (!address || address.length < 15) {
      showMessage("⚠️ Enter a valid wallet address", "red");
      return;
    }

    if (currentUserId) {
      const ref = doc(db, "users", currentUserId);
      await updateDoc(ref, { primaryAddress: address });
      showMessage("⭐ Primary address updated!");
    }
  }

  onAuthStateChanged(auth, (user) => {
    if (user) currentUserId = user.uid;
  });
</script>

</body>
</html>
